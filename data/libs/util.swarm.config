#!/usr/bin/env bash
#
# Prepare functions
# to display functions to End User :P
#
	swarm.eu.function.list() { #
	# Prints a list of properly declared functions
	# Please see: ./docs/{MANUAL,SYNTAX}.md)
		local tmp_list=""
		local tmp_oldpwd="${PWD:-$($PWD_EXEC)}"

		raw_output() {
			(
				cd "$SWARM_DIR_LIBS"
				$GREP init.*"() {" * | $GREP -v GREP
				$GREP cfg.*"() {" * | $GREP -v GREP
				$GREP swarm.*"() {" * | $GREP -v GREP
				cd "$tmp_oldpwd"
			) | while IFS=": " read one two three
			do
				# The IFS takes care of the GREP filenames
				# and this variable-regex takes care of the function definition
				echo "${two/()}"
			done
		}

		# Show data
		raw_output | sort -u
		unset -f raw_output
	}
	swarm.eu.function.show() { # MODE FUNCTIONNAME		## MODE= --text || --code
	# Prints either these 2 comment lines or the code
	# Please see: ./docs/{MANUAL,SYNTAX}.md)
		#
		# Vars
		#
			local tmp_oldpwd="${PWD:-$($PWD_EXEC)}"
			local GREP_OPTS=""
		#
		# Check for args
		#
			local MODE=none
			case "$1" in
				"--text")
					MODE=text
					shift
					;;
				"--code")
					MODE=code
					shift
					;;
				*)
					MODE=text
					#return 1
					;;
			esac
		#
		# Code
		#
			# Prepare command
			case "$MODE" in
				"text")
					GREP_OPTS="-h -a2  ${1}"
					cd "$SWARM_DIR_LIBS"
					$GREP $GREP_OPTS *
					cd "$tmp_oldpwd"
					;;
				"code")
					type "$1"
					;;
			esac
	}
